## Pancake Screener

### Abstract
Pancake Screener designed to find a return on an investment in a Pancakeswap V2 liquidity pool. This Project finds out the return on LP Pools (a.k.a Farms) and Imperamanet Loss on the investment. You can simulate your return by setting your investment. A complete report of each return  will be generated in a CSV file with the final results.
### Detailed Specifications:

#### Detailed Breakdown of how Total Rewards from the Pools are Calculated:

#### Total Reward From the Pool:
> **Total Reward From Pool = Annual_LP_Reward + Annual_Staking_Reward**

##### Yearly LP Reward (Basic Earning):
>  **Annual_LP_Reward = (Fee_Generated_in_24H  * 365 / (TVL + Balance)) * 100**

##### Fee_Generated:
>  **Fee_Generated_in_24H  = Volume_24H * 0.17**

##### Total Liquidity Locked:
>  **TVL = Reserves Of One Token In Pool * Price of Token * 2**


##### Price In USDT:
>  **Price in USDT  = Reserves of Token / Reserves of USDT**

##### Mining Reward 
>  **Mining Reward  = ((CAKE PRICE * (ALLOCATED POINT / TOTAL POINT) * REWARD * Daily_Blocks * Days_In_Year) / (Farm_Liquidity + BALANCE)) * 100)**

##### Farm Liquidity:
>  **Farm_Liquidity = (TVL / max_supply) * masterchef_balance**



**Basic Earning**

Basic Earning from the pool is based on the trading volume of the pool. Every pool on pancakeswap has a fixed fee of 0.17%. For every transaction pool, liquidity providers earn 0.17% in reward against their investment in the pool. This reward is equally divided among pool members as their pool liquidity share. This Reward is Basic Earning and is also known as LP Reward. 
In Pancake Screener Basic Earning is calculated using the Formula Given below. The daily volume of the pool is fetched from [pancake.finance](https://pancakeswap.finance/info/pools) for each pool. The average liquidity balance is the amount of liquidity locked into the pool. a.k.a TVL. TVL Is fetched from the pool smart contract. We Fetch total reserves from the pool using the function getReserves. This function provides the reserves of both tokens in the pool. We select one of the token's reserves and convert those into a dollar value. For conversion of reserves to dollar amount we convert reserves from to Wei to eth amount and then find that tokens price in usdt. For finding the price in usdt. we find the pair address of that token with usdt,using pancakeswap factory contract. Using that pair smart contract we fetches the reserves of that pool and calculate price using formula (token reserves / usdt Reserves), please refer to Price In USDT formula above.
after finding the dollar value of the reserves, we multiply that by 2 to get the final answer of TVL in the pool, please refer to Total Liquidity Locked formula above.


Now we find the fee generated from the volume of 24h of the pool. please refer to Fee_Generated formula above.

After finding the TVL and Fee Generated, We can calculate today's LP Reward

This LP_Reward is on the daily fee. We can also find yearly LP_Reward / Basic Earning

BALANCE In this calculation is the amount of our investment. You can set the balance to 0 in config.ini if you want to get original values.

**Mining Reward**

Pancake Pool provides us with a mining reward against our LP provided to the pools. We can stake them in the pool and get a mining reward from it. 
There are two types of pools on master chef v2. Regular and Special Pools. Both pool types have different rewards ratios and total allocation points.
For Finding the Mining Reward, we have to find the liquidity in the mining pool. We can find that using a pool smart contract

TVL is the same as Basic Earning. Max Supply is fetched from pools smart contract. MasterChef Balance is the balance of masterchef in that liquidity pool.

Daily Blocks are the number of blocks generated by BSC chain. which is 28800.  APR Rate we have to multiply our daily reward by the number of days for the annual reward. Each Pool has allocated points for its share in the reward of cake. This allocated Point is fetched from the masterchef router.
The cake price is fetched from the blockchain using cake-usdt pool. BALANCE In this calculation is the amount of our investment. You can set the balance to 0 in config.ini if you want to get original values.


**Masterchef Contract:**
>[0xa5f8C5Dbd5F286960b9d90548680aE5ebFf07652](https://bscscan.com/address/0xa5f8C5Dbd5F286960b9d90548680aE5ebFf07652#readContract)
> 
## Requirements Image

![Alt text](python/image.png?600x200 "Title") 

## Screener Process

![Alt text](python/flowchart.png?600x200 "Title") 

## Config File
### Setup config.ini

BALANCE: This the amount of user's invesment each pool.

url: This is the address to use for fetching volume of each pool

driver: this is the Path for the driver file for using selenium in linux OS

windows_driver: this is the Path for the driver for using selenium in windows OS

node_address: This is the address of node to use to connect to BSC Blockchain

pancake_factory: This the address to pancakeswap factory smart contract on BSC

usdt_address: This is the address of USDT smart contract on BSC 

pancake_masterChef: This is the address of pancakeswap masterchef v2

cake_usdt: This the pool address for CAKE USDT Pool

CAKE: This is the smart contract address of cake token on BSC 

POOL_LIMIT: This is the limit for number of pool to explore while in debugging mode

## Results 
index: The index no. of the pool on masterchef smart contract

lpToken: The address of the pool

allocPoint: This is the allocation Points by the masterchef smartcontract

isRegular: The Type of Pool 

token0: The address of the token 0 in the pool

token0_name: the Symbol of the token 0 in the pool

token1: The address of the token 1 in the pool

token1_name: The symbol of the token 1 in the pool

average_daily_liquidity_of_pool_in_$: 7 day average of total volume locked in Pool

average_daily_trading_volume_of_pool_in_$: 7 Day average of daily volume on the pool

exchange_fee%: Fee of the particular pool

daily_basic_earning_in_$: Amount of return on our Liquidity investment on daily basis in dollars.

daily_basic_earning_in_%: Amount of return on our Liquidity investment on daily basis in percentage.

annual_basic_earning_in_$: Amount of return on our Liquidity investment on yearly basis in dollars.

annual_basic_earning_in_%: Amount of return on our Liquidity investment on yearly basis in percentage.

total_liquidity_pool_size_in_$: Value of total LP Tokens staked in the Farm.

daily_mining_reward_in_%: Amount of return on our LP/Mining Tokens on daily basis in percentage.

annual_mining_reward_in_%: Amount of return on our LP/Mining Tokens on yearly basis in percentage

daily_mining_reward_in_$: Amount of return on our LP/Mining Tokens on daily basis in dollars.

annual_mining_reward_in_$:  Amount of return on our LP/Mining Tokens on yearly basis in dollars

## Dependencies Installation
This is a step by step guide for running Pancakescreener.

**1) Python Installation**

1) First we have to install [python](https://www.python.org/downloads/). This Program was designed using python 3.9

**2) VS Build Tool Installation**

1) Download and install VS Build tool [VS Build Tools](https://aka.ms/vs/17/release/vs_BuildTools.exe) 

**3) PATH setup**

We have to set path variable for python in environment, if its not done automatically.

    a) open run (click windows key + r)

    b) type cmd and click enter

    c) once the terminal is open

    d) type python --version and click enter, if it returns with python version then skip to step 3.

    e) Right-clicking This PC and going to Properties.

    f) Clicking on the Advanced system settings in the menu on the left.

    g) Clicking on the Environment Variables button o​n the bottom right.

    h) In the System variables section, selecting the Path variable and clicking on Edit. The next screen will show all the directories that 
    are currently a part of the PATH variable.
    
    i) Clicking on New and entering Python’s install directory.

**4) Downloading Chrome Driver For Selenium**

We need chrome driver for running selenium. Kindly open your chrome and go to settings. and Select the tab About Chrome. You will see a bunch of information. Kindly check your chrome version. We are going to download the compatible version of chrome drivers for our Chrome from the following link. [Driver Link](https://chromedriver.chromium.org/downloads). Look and open the link which matches your chrome version. Now you will see a list of other options to download different zip. Select the version ending with win32.zip and download the file. Once the file is downloaded, extra the chromedriver.exe to any folder. Provide the chromedriver.exe path into config.ini file.

## How to Run

run command in cmd

    pip install -r requirements.txt
    python3 main.py or python main.py


## Clone a repository

Use these steps to clone from SourceTree, our client for using the repository command-line free. Cloning allows you to work on your files locally. If you don't yet have SourceTree, [download and install first](https://www.sourcetreeapp.com/). If you prefer to clone from the command line, see [Clone a repository](https://confluence.atlassian.com/x/4whODQ).

1. You’ll see the clone button under the **Source** heading. Click that button.
2. Now click **Check out in SourceTree**. You may need to create a SourceTree account or log in.
3. When you see the **Clone New** dialog in SourceTree, update the destination path and name if you’d like to and then click **Clone**.
4. Open the directory you just created to see your repository’s files.

Now that you're more familiar with your Bitbucket repository, go ahead and add a new file locally. You can [push your change back to Bitbucket with SourceTree](https://confluence.atlassian.com/x/iqyBMg), or you can [add, commit,](https://confluence.atlassian.com/x/8QhODQ) and [push from the command line](https://confluence.atlassian.com/x/NQ0zDQ).
